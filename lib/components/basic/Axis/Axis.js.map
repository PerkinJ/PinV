{"version":3,"sources":["../../../../src/components/basic/Axis/Axis.js"],"names":["d3","getScaleX","props","length","domain","data","dataKey","scale","linear","range","console","error","xDomian","max","d","scaleLinear","getScaleY","yDomain","Axis","orient","tickSize","textAnchor","unit","tickFormat","type","hide","rest","ticks","delta","Number","path","hidden","show","stroke","map","space","tick","format"],"mappings":"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","file":"Axis.js","sourcesContent":["import { h } from 'preact'\nimport * as d3 from 'd3'\nimport styles from './index.less'\n// 计算x轴的长度\nconst getScaleX = (props) => {\n\tlet { length, domain = '', data, dataKey } = props\n\tif (domain) {\n\t\treturn d3.scale.linear()\n\t\t\t.domain(domain)\n\t\t\t.range([0, length])\n\t} else {\n\t\tif (!data) console.error(\"you didn't add data\")\n\t\tif (!dataKey) console.error(\"you didn't add dataKey\")\n\t\tlet xDomian = d3.max(data, (d) => d[dataKey])\n\t\treturn d3.scaleLinear()\n\t\t\t.domain([0, xDomian])\n\t\t\t.range([0, length])\n\t}\n\n}\n// 计算y轴的长度\nconst getScaleY = (props) => {\n\tlet { length, domain = '', data, dataKey } = props\n\tif (domain) {\n\t\treturn d3.scale.linear()\n\t\t\t.domain(domain)\n\t\t\t.range([length, 0])\n\t} else {\n\t\tif (!data) console.error(\"you didn't add data\")\n\t\tif (!dataKey) console.error(\"you didn't add dataKey\")\n\t\tlet yDomain = 1.2 * d3.max(data, (d) => d[dataKey])\n\t\treturn d3.scaleLinear()\n\t\t\t.domain([yDomain, 0])\n\t\t\t.range([0, length])\n\t}\n}\n\nconst Axis = (props) => {\n\tconst { data, orient = 'bottom', tickSize = null, textAnchor, unit, tickFormat = '', type = 'x', length, hide = false, ...rest } = props\n\tlet scale = type === 'x' ? getScaleX(props) : getScaleY(props)\n\tlet ticks = type === 'x' ? scale.ticks(data.length) : scale.ticks(tickSize)\n\tlet delta = Number(length / ticks.length)\n\tlet path = orient === \"bottom\" ? `M0.5,6V0.5H${length + 1.5 * delta}V6` : `M-6,${length}H0.5V0.5H-6`\n\treturn (\n\t\t<g {...rest} fill=\"none\">\n\t\t\t<path class={hide ? styles.hidden : styles.show} stroke={props.stroke} d={path} />\n\t\t\t{ticks.map(d => {\n\t\t\t\tlet space = scale(d)\n\t\t\t\tif (orient === \"bottom\") {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<g class={styles.tick} opacity=\"1\" transform={`translate( ${space + delta / 2},0)`}>\n\t\t\t\t\t\t\t<line stroke=\"#000\" y2=\"6\" />\n\t\t\t\t\t\t\t<text text-anchor={textAnchor} fill=\"#000\" y=\"9\" dy=\"0.71em\">{d}{unit}</text>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t)\n\t\t\t\t} else {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<g class={styles.tick} opacity=\"1\" transform={`translate(0,${space} )`}>\n\t\t\t\t\t\t\t<line stroke=\"#000\" x2=\"-6\" />\n\t\t\t\t\t\t\t<text text-anchor={textAnchor} fill=\"#000\" x=\"-9\" dy=\"0.32em\">{d3.format(tickFormat)(d)}{unit}</text>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t})}\n\t\t</g>\n\t)\n}\n\nexport default Axis\n"]}