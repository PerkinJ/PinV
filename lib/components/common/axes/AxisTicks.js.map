{"version":3,"sources":["../../../../src/components/common/axes/AxisTicks.js"],"names":["AxisTicks","render","props","tr","ticks","scale","adjustedScale","textAnchor","textTransform","tickFormat","y1","y2","dy","x1","x2","gridStrokeWidth","gridStroke","gridStrokeDashArray","x2grid","y2grid","gridOn","sign","orient","tickSpacing","Math","max","innerTickSize","tickPadding","tickValues","apply","tickArguments","domain","tickFormatting","d","rangeBand","tick","height","width","horizontalChart","gridHorizontal","gridHorizontalStrokeWidth","gridHorizontalStroke","gridHorizontalStrokeDash","gridVertical","gridVerticalStrokeWidth","gridVerticalStroke","gridVerticalStrokeDash","gridLine","pos","orient2nd","strokeWidth","shapeRendering","stroke","strokeDasharray","optionalTextProps","transform","map","idx","opacity","tickStroke","tickTextStroke","fill","defaultProps","outerTickSize"],"mappings":"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","file":"AxisTicks.js","sourcesContent":["import { h, Component } from 'preact'\nclass AxisTicks extends Component {\n\tstatic defaultProps = {\n\t\tinnerTickSize: 6,\n\t\touterTickSize: 6,\n\t\ttickStroke: '#000',\n\t\ttickPadding: 3,\n\t\ttickArguments: [10],\n\t\ttickValues: null,\n\t\tgridHorizontal: false,\n\t\tgridVertical: false,\n\t\tgridHorizontalStroke: '#D8D7D7',\n\t\tgridVerticalStroke: '#D8D7D7',\n\t\tgridHorizontalStrokeWidth: 1,\n\t\tgridVerticalStrokeWidth: 1,\n\t\tgridHorizontalStrokeDash: '5, 5',\n\t\tgridVerticalStrokeDash: '5, 5'\n\t}\n\trender() {\n\t\tlet props = this.props\n\n\t\tlet tr,\n\t\t\tticks,\n\t\t\tscale,\n\t\t\tadjustedScale,\n\t\t\t// orient,\n\t\t\ttextAnchor,\n\t\t\ttextTransform,\n\t\t\ttickFormat,\n\t\t\ty1, y2, dy,  x1, x2\n\n\t\tlet gridStrokeWidth,\n\t\t\tgridStroke,\n\t\t\tgridStrokeDashArray,\n\t\t\tx2grid,\n\t\t\ty2grid\n\t\tlet gridOn = false\n\n\t\tlet sign = props.orient === 'top' || props.orient === 'right' ? -1 : 1\n\t\tlet tickSpacing = Math.max(props.innerTickSize, 0) + props.tickPadding\n\t\tscale = props.scale\n\n\t\tif (props.tickValues) {\n\t\t\tticks = props.tickValues\n\t\t} else if (scale.ticks) {\n\t\t\tticks = scale.ticks.apply(scale, props.tickArguments)\n\t\t} else {\n\t\t\tticks = scale.domain()\n\t\t}\n\n\t\tif (props.tickFormatting) {\n\t\t\ttickFormat = props.tickFormatting\n\t\t} else if (scale.tickFormat) {\n\t\t\ttickFormat = scale.tickFormat.apply(scale, props.tickArguments)\n\t\t} else {\n\t\t\ttickFormat = (d) => d\n\t\t}\n\n\t\tadjustedScale = scale.rangeBand ? (d) => { return scale(d) + scale.rangeBand() / 2 } : scale\n\t\t// Still working on this\n\t\t// Ticks and lines are not fully aligned\n\t\t// in some orientations\n\t\tswitch (props.orient) {\n\t\t\tcase 'top':\n\t\t\t\ttr = (tick) => `translate(${adjustedScale(tick)},0)`\n\t\t\t\ttextAnchor = \"middle\"\n\t\t\t\ty2 = props.innerTickSize * sign\n\t\t\t\ty1 = tickSpacing * sign\n\t\t\t\tdy = sign < 0 ? \"0em\" : \".71em\"\n\t\t\t\tx2grid = 0\n\t\t\t\ty2grid = -props.height\n\t\t\t\tbreak\n\t\t\tcase 'bottom':\n\t\t\t\ttr = (tick) => `translate(${adjustedScale(tick)},0)`\n\t\t\t\ttextAnchor = \"middle\"\n\t\t\t\ty2 = props.innerTickSize * sign\n\t\t\t\ty1 = tickSpacing * sign\n\t\t\t\tx1= -10 // 手动添加偏移\n\t\t\t\tdy = sign < 0 ? \"0em\" : \".71em\"\n\t\t\t\tx2grid = 0\n\t\t\t\ty2grid = -props.height\n\t\t\t\tbreak\n\t\t\tcase 'left':\n\t\t\t\ttr = (tick) => `translate(0,${adjustedScale(tick)})`\n\t\t\t\ttextAnchor = \"end\"\n\t\t\t\tx2 = props.innerTickSize * -sign\n\t\t\t\tx1 = tickSpacing * -sign - 20   // 手动添加偏移\n\t\t\t\tdy = \".32em\"\n\t\t\t\tx2grid = props.width\n\t\t\t\ty2grid = 0\n\t\t\t\tbreak\n\t\t\tcase 'right':\n\t\t\t\ttr = (tick) => `translate(0,${adjustedScale(tick)})`\n\t\t\t\ttextAnchor = \"start\"\n\t\t\t\tx2 = props.innerTickSize * -sign\n\t\t\t\tx1 = tickSpacing * -sign\n\t\t\t\tdy = \".32em\"\n\t\t\t\tx2grid = -props.width\n\t\t\t\ty2grid = 0\n\t\t\t\tbreak\n\t\t}\n\n\t\tif (props.horizontalChart) {\n\t\t\ttextTransform = \"rotate(-90)\" [y1, x1] = [x1, -y1 || 0]\n\n\t\t\tswitch (props.orient) {\n\t\t\t\tcase 'top':\n\t\t\t\t\ttextAnchor = \"start\"\n\t\t\t\t\tdy = \".32em\"\n\t\t\t\t\tbreak\n\t\t\t\tcase 'bottom':\n\t\t\t\t\ttextAnchor = \"end\"\n\t\t\t\t\tdy = \".32em\"\n\t\t\t\t\tbreak\n\t\t\t\tcase 'left':\n\t\t\t\t\ttextAnchor = 'middle'\n\t\t\t\t\tdy = sign < 0 ? \".71em\" : \"0em\"\n\t\t\t\t\tbreak\n\t\t\t\tcase 'right':\n\t\t\t\t\ttextAnchor = 'middle'\n\t\t\t\t\tdy = sign < 0 ? \".71em\" : \"0em\"\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tif (props.gridHorizontal) {\n\t\t\tgridOn = true\n\t\t\tgridStrokeWidth = props.gridHorizontalStrokeWidth\n\t\t\tgridStroke = props.gridHorizontalStroke\n\t\t\tgridStrokeDashArray = props.gridHorizontalStrokeDash\n\t\t}\n\t\telse if (props.gridVertical) {\n\t\t\tgridOn = true\n\t\t\tgridStrokeWidth = props.gridVerticalStrokeWidth\n\t\t\tgridStroke = props.gridVerticalStroke\n\t\t\tgridStrokeDashArray = props.gridVerticalStrokeDash\n\t\t}\n\n\t\t// return grid line if grid is enabled and grid line is not on at same position as other axis.\n\t\tlet gridLine = function (pos) {\n\t\t\tif (gridOn\n\t\t\t\t&& !(props.orient2nd == 'left' && pos == 0)\n\t\t\t\t&& !(props.orient2nd == 'right' && pos == props.width)\n\t\t\t\t&& !((props.orient == 'left' || props.orient == 'right') && pos == props.height)\n\t\t\t) {\n\t\t\t\treturn (\n\t\t\t\t\t<line style={{\n\t\t\t\t\t\tstrokeWidth: gridStrokeWidth,\n\t\t\t\t\t\tshapeRendering: 'crispEdges',\n\t\t\t\t\t\tstroke: gridStroke,\n\t\t\t\t\t\tstrokeDasharray: gridStrokeDashArray\n\t\t\t\t\t}} x2={x2grid} y2={y2grid} />\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\n\t\tlet optionalTextProps = textTransform ? {\n\t\t\ttransform: textTransform\n\t\t} : {}\n\n\t\treturn (\n\t\t\t<g>\n\t\t\t\t{ticks.map((tick, idx) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<g key={idx} className=\"tick\" transform={tr(tick)} >\n\t\t\t\t\t\t\t{gridLine(adjustedScale(tick))}\n\t\t\t\t\t\t\t<line style={{ shapeRendering: 'crispEdges', opacity: '1', stroke: props.tickStroke }} x2={x2} y2={y2} />\n\t\t\t\t\t\t\t<text\n\t\t\t\t\t\t\t\tstrokeWidth=\"0.01\"\n\t\t\t\t\t\t\t\tdy={dy} x={x1} y={y1}\n\t\t\t\t\t\t\t\tstyle={{ stroke: props.tickTextStroke, fill: props.tickTextStroke }}\n\t\t\t\t\t\t\t\ttextAnchor={textAnchor}\n\t\t\t\t\t\t\t\t{...optionalTextProps}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{tickFormat(tick)}\n\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t\t}\n\t\t\t</g>\n\t\t)\n\t}\n}\nexport default AxisTicks\n"]}