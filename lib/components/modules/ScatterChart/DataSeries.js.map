{"version":3,"sources":["../../../../src/components/modules/ScatterChart/DataSeries.js"],"names":["d3","DataSeries","_isDate","d","accessor","Object","prototype","toString","call","render","value","width","height","data","xScale","yScale","xAccessor","yAccessor","colors","colorAccessor","hoverAnimation","circleRadius","onMouseOver","onMouseLeave","interpolatePath","line","y","values","x","getTime","voronoi","coord","extent","cx","cy","circleFill","regions","polygons","map","vnode","idx","point","seriesIndex","xValue","yValue","seriesName","series","name","defaultProps","interpolationType"],"mappings":"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","file":"DataSeries.js","sourcesContent":["import { h, Component } from 'preact'\nimport * as d3 from 'd3'\nimport VoronoiCircleContainer from './VoronoiCircleContainer'\n\nclass DataSeries extends Component {\n\tstatic defaultProps = {\n\t\tdata: [],\n\t\txAccessor: (d) => d.x,\n\t\tyAccessor: (d) => d.y,\n\t\tinterpolationType: 'linear',\n\t\thoverAnimation: false\n\t}\n\t_isDate(d, accessor) {\n\t\treturn Object.prototype.toString.call(accessor(d)) === '[object Date]'\n\t}\n\trender({ value, width, height, data, xScale, yScale, xAccessor, yAccessor, colors, colorAccessor,hoverAnimation,circleRadius,onMouseOver,onMouseLeave }) {\n\t\tlet interpolatePath = d3.line()\n\t\t\t.y((d) => yScale(yAccessor(d)))\n\t\t\t// .interpolate(interpolationType)\n\n\t\tif (this._isDate(data[0].values[0], xAccessor)) {\n\t\t\tinterpolatePath.x(d =>\n\t\t\t\txScale(xAccessor(d).getTime())\n\t\t\t)\n\t\t} else {\n\t\t\tinterpolatePath.x((d) =>\n\t\t\t\txScale(xAccessor(d))\n\t\t\t)\n\t\t}\n\n\t\tlet voronoi = d3.voronoi()\n\t\t\t.x(d => xScale(d.coord.x))\n\t\t\t.y(d => yScale(d.coord.y))\n\t\t\t.extent([[0, 0], [width, height]])\n\t\tlet cx, cy, circleFill\n\t\t// 为每个circle添加一个多边形交互区域，即VoronoiCircle\n\t\tlet regions = voronoi(value).polygons().map((vnode, idx) => {\n\t\t\tlet point = vnode.data.coord\n\t\t\tif (Object.prototype.toString.call(xAccessor(point)) === '[object Date]') {\n\t\t\t\tcx = xScale(xAccessor(point).getTime())\n\t\t\t} else {\n\t\t\t\tcx = xScale(xAccessor(point))\n\t\t\t}\n\t\t\tif (Object.prototype.toString.call(yAccessor(point)) === '[object Date]') {\n\t\t\t\tcy = yScale(yAccessor(point).getTime())\n\t\t\t} else {\n\t\t\t\tcy = yScale(yAccessor(point))\n\t\t\t}\n\t\t\tcircleFill = colors(colorAccessor(vnode, vnode.data.seriesIndex))\n\n\t\t\treturn (\n\t\t\t\t<VoronoiCircleContainer\n\t\t\t\t\tkey={idx}\n\t\t\t\t\tcircleFill={circleFill}\n\t\t\t\t\tvnode={vnode}\n\t\t\t\t\thoverAnimation={hoverAnimation}\n\t\t\t\t\tcx={cx} cy={cy}\n\t\t\t\t\tcircleRadius={circleRadius}\n\t\t\t\t\tonMouseOver={onMouseOver}\n\t\t\t\t\tonMouseLeave={onMouseLeave}\n\t\t\t\t\tdataPoint={{ xValue: xAccessor(point), yValue: yAccessor(point), seriesName: vnode.data.series.name }}\n\t\t\t\t/>\n\t\t\t)\n\t\t})\n\t\treturn (\n\t\t\t<g>\n\t\t\t\t<g>{regions}</g>\n\t\t\t</g>\n\t\t)\n\t}\n}\n\nexport default DataSeries\n"]}