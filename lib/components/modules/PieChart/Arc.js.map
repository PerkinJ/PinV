{"version":3,"sources":["../../../../src/components/modules/PieChart/Arc.js"],"names":["d3","Arc","renderInnerLabel","props","arc","value","sum","toFixed","formattedValue","valueTextFormatter","centroid","valueTextFill","fontSize","renderOuterLabel","rotate","startAngle","endAngle","Math","PI","radius","outerRadius","dist","angle","x","sin","y","cos","t","labelTextFill","label","render","innerRadius","fill","sectorBorderColor","handleMouseOver","handleMouseLeave","showOuterLabels","showInnerLabels","defaultProps"],"mappings":"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","file":"Arc.js","sourcesContent":["import { h, Component } from 'preact'\nimport * as d3 from 'd3'\n\nclass Arc extends Component {\n\tstatic defaultProps = {\n\t\tlabelTextFill: 'black',\n\t\tvalueTextFill: 'white',\n\t\tshowInnerLabels: true,\n\t\tshowOuterLabels: true\n\t}\n\trenderInnerLabel = (props, arc) => {\n\t\t// make value text can be formatted\n\t\tlet value = (+props.value / props.sum * 100).toFixed(1)\n\t\tlet formattedValue = props.valueTextFormatter(value)\n\t\treturn (\n\t\t\t<text\n\t\t\t\tclassName='piechart-value'\n\t\t\t\ttransform={`translate(${arc.centroid()})`}\n\t\t\t\tdy='.35em'\n\t\t\t\tstyle={{\n\t\t\t\t\t'shapeRendering': 'crispEdges',\n\t\t\t\t\t'textAnchor': 'middle',\n\t\t\t\t\t'fill': props.valueTextFill,\n\t\t\t\t\tfontSize: 12\n\t\t\t\t}}>\n\t\t\t\t{value >= 1 && formattedValue}\n\t\t\t</text>\n\t\t)\n\t}\n\n\trenderOuterLabel(props) {\n\n\t\tlet rotate = `rotate(${(props.startAngle + props.endAngle) / 2 * (180 / Math.PI)})`\n\t\t// let positions = arc.centroid()\n\t\tlet radius = props.outerRadius\n\t\tlet dist = radius + 35\n\t\tlet angle = (props.startAngle + props.endAngle) / 2\n\t\tlet x = dist * (1.1 * Math.sin(angle))\n\t\tlet y = -dist * Math.cos(angle)\n\t\tlet t = `translate(${x},${y})`\n\t\tlet value = (+props.value / props.sum * 100).toFixed(1)\n\t\treturn (\n\t\t\t<g>\n\t\t\t\t{value >= 1 ? <g>\n\t\t\t\t\t<line\n\t\t\t\t\t\tx1='0'\n\t\t\t\t\t\tx2='0'\n\t\t\t\t\t\ty1={-radius}\n\t\t\t\t\t\ty2={-radius - 20}\n\t\t\t\t\t\tstroke={props.labelTextFill}\n\t\t\t\t\t\ttransform={rotate}\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t'fill': props.labelTextFill,\n\t\t\t\t\t\t\t'strokeWidth': 1\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t\t<text\n\t\t\t\t\t\tclassName='piechart-label'\n\t\t\t\t\t\ttransform={t}\n\t\t\t\t\t\tdy='.35em'\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t'textAnchor': 'middle',\n\t\t\t\t\t\t\t'fill': props.labelTextFill,\n\t\t\t\t\t\t\t'shapeRendering': 'crispEdges',\n\t\t\t\t\t\t\tfontSize: 12\n\t\t\t\t\t\t}}>\n\t\t\t\t\t\t{props.label}\n\t\t\t\t\t</text>\n\t\t\t\t</g> : null}\n\t\t\t</g>\n\t\t)\n\t}\n\trender() {\n\t\tlet props = this.props\n\n\t\tlet arc = d3.arc()\n\t\t\t.innerRadius(props.innerRadius)\n\t\t\t.outerRadius(props.outerRadius)\n\t\t\t.startAngle(props.startAngle)\n\t\t\t.endAngle(props.endAngle)\n\n\t\treturn (\n\t\t\t<g className='piechart-arc' >\n\t\t\t\t<path\n\t\t\t\t\td={arc()}\n\t\t\t\t\tfill={props.fill}\n\t\t\t\t\tstroke={props.sectorBorderColor}\n\t\t\t\t\tonMouseOver={props.handleMouseOver}\n\t\t\t\t\tonMouseLeave={props.handleMouseLeave}\n\t\t\t\t/>\n\t\t\t\t{props.showOuterLabels ? this.renderOuterLabel(props, arc) : null}\n\t\t\t\t{props.showInnerLabels ? this.renderInnerLabel(props, arc) : null}\n\t\t\t</g>\n\t\t)\n\t}\n}\nexport default Arc\n"]}