{"version":3,"sources":["../../../../src/components/modules/PieChart/Arc.js"],"names":["d3","Arc","renderInnerLabel","props","arc","formattedValue","valueTextFormatter","Math","round","value","sum","toFixed","centroid","valueTextFill","renderOuterLabel","rotate","startAngle","endAngle","PI","radius","outerRadius","dist","angle","x","sin","y","cos","t","labelTextFill","label","render","innerRadius","fill","sectorBorderColor","handleMouseOver","handleMouseLeave","showOuterLabels","showInnerLabels","defaultProps"],"mappings":";;;;;;AAAA;;AACA;;IAAYA,E;;;;;;;;;;IAENC,G;;;;;;;;;;;;0IAOLC,gB,GAAmB,UAACC,KAAD,EAAQC,GAAR,EAAe;AACjC;AACA,OAAIC,iBAAiBF,MAAMG,kBAAN,CAAyBC,KAAKC,KAAL,CAAWL,MAAMM,KAAN,GAAYN,MAAMO,GAAlB,GAAuB,GAAlC,EAAuCC,OAAvC,CAA+C,CAA/C,CAAzB,CAArB;AACA,UACC;AAAA;AAAA;AACC,gBAAU,gBADX;AAEC,+BAAwBP,IAAIQ,QAAJ,EAAxB,MAFD;AAGC,SAAG,OAHJ;AAIC,YAAO;AACN,wBAAkB,YADZ;AAEN,oBAAc,QAFR;AAGN,cAAQT,MAAMU;AAHR,MAJR;AASER;AATF,IADD;AAaA,G;;;eAEDS,gB,6BAAiBX,K,EAAO;;AAEvB,MAAIY,qBAAmB,CAACZ,MAAMa,UAAN,GAAmBb,MAAMc,QAA1B,IAAsC,CAAtC,IAA2C,MAAMV,KAAKW,EAAtD,CAAnB,MAAJ;AACA;AACA,MAAIC,SAAShB,MAAMiB,WAAnB;AACA,MAAIC,OAAOF,SAAS,EAApB;AACA,MAAIG,QAAQ,CAACnB,MAAMa,UAAN,GAAmBb,MAAMc,QAA1B,IAAsC,CAAlD;AACA,MAAIM,IAAIF,QAAQ,MAAMd,KAAKiB,GAAL,CAASF,KAAT,CAAd,CAAR;AACA,MAAIG,IAAI,CAACJ,IAAD,GAAQd,KAAKmB,GAAL,CAASJ,KAAT,CAAhB;AACA,MAAIK,mBAAiBJ,CAAjB,SAAsBE,CAAtB,MAAJ;;AAEA,SACC;AAAA;AAAA;AACC;AACC,QAAG,GADJ;AAEC,QAAG,GAFJ;AAGC,QAAI,CAACN,MAAD,GAAU,CAHf;AAIC,QAAI,CAACA,MAAD,GAAU,EAJf;AAKC,YAAQhB,MAAMyB,aALf;AAMC,eAAWb,MANZ;AAOC,WAAO;AACN,aAAQZ,MAAMyB,aADR;AAEN,oBAAe;AAFT;AAPR,KADD;AAaC;AAAA;AAAA;AACC,gBAAU,gBADX;AAEC,gBAAWD,CAFZ;AAGC,SAAG,OAHJ;AAIC,YAAO;AACN,oBAAc,QADR;AAEN,cAAQxB,MAAMyB,aAFR;AAGN,wBAAkB;AAHZ,MAJR;AASEzB,UAAM0B;AATR;AAbD,GADD;AA2BA,E;;eACDC,M,qBAAS;AACR,MAAI3B,QAAQ,KAAKA,KAAjB;;AAEA,MAAIC,MAAMJ,GAAGI,GAAH,GACR2B,WADQ,CACI5B,MAAM4B,WADV,EAERX,WAFQ,CAEIjB,MAAMiB,WAFV,EAGRJ,UAHQ,CAGGb,MAAMa,UAHT,EAIRC,QAJQ,CAICd,MAAMc,QAJP,CAAV;;AAMA,SACC;AAAA;AAAA,KAAG,WAAU,cAAb;AACC;AACC,OAAGb,KADJ;AAEC,UAAMD,MAAM6B,IAFb;AAGC,YAAQ7B,MAAM8B,iBAHf;AAIC,iBAAa9B,MAAM+B,eAJpB;AAKC,kBAAc/B,MAAMgC;AALrB,KADD;AAQEhC,SAAMiC,eAAN,GAAwB,KAAKtB,gBAAL,CAAsBX,KAAtB,EAA6BC,GAA7B,CAAxB,GAA4D,IAR9D;AASED,SAAMkC,eAAN,GAAwB,KAAKnC,gBAAL,CAAsBC,KAAtB,EAA6BC,GAA7B,CAAxB,GAA4D;AAT9D,GADD;AAaA,E;;;6BArFMkC,Y,GAAe;AACrBV,gBAAe,OADM;AAErBf,gBAAe,OAFM;AAGrBwB,kBAAiB,IAHI;AAIrBD,kBAAiB;AAJI,C;kBAuFRnC,G","file":"Arc.js","sourcesContent":["import { h, Component } from 'preact'\nimport * as d3 from 'd3'\n\nclass Arc extends Component {\n\tstatic defaultProps = {\n\t\tlabelTextFill: 'black',\n\t\tvalueTextFill: 'white',\n\t\tshowInnerLabels: true,\n\t\tshowOuterLabels: true\n\t}\n\trenderInnerLabel = (props, arc) =>{\n\t\t// make value text can be formatted\n\t\tlet formattedValue = props.valueTextFormatter(Math.round(props.value/props.sum *100).toFixed(1))\n\t\treturn (\n\t\t\t<text\n\t\t\t\tclassName='piechart-value'\n\t\t\t\ttransform={`translate(${arc.centroid()})`}\n\t\t\t\tdy='.35em'\n\t\t\t\tstyle={{\n\t\t\t\t\t'shapeRendering': 'crispEdges',\n\t\t\t\t\t'textAnchor': 'middle',\n\t\t\t\t\t'fill': props.valueTextFill\n\t\t\t\t}}>\n\t\t\t\t{formattedValue}\n\t\t\t</text>\n\t\t)\n\t}\n\n\trenderOuterLabel(props) {\n\n\t\tlet rotate = `rotate(${(props.startAngle + props.endAngle) / 2 * (180 / Math.PI)})`\n\t\t// let positions = arc.centroid()\n\t\tlet radius = props.outerRadius\n\t\tlet dist = radius + 35\n\t\tlet angle = (props.startAngle + props.endAngle) / 2\n\t\tlet x = dist * (1.2 * Math.sin(angle))\n\t\tlet y = -dist * Math.cos(angle)\n\t\tlet t = `translate(${x},${y})`\n\n\t\treturn (\n\t\t\t<g>\n\t\t\t\t<line\n\t\t\t\t\tx1='0'\n\t\t\t\t\tx2='0'\n\t\t\t\t\ty1={-radius - 2}\n\t\t\t\t\ty2={-radius - 26}\n\t\t\t\t\tstroke={props.labelTextFill}\n\t\t\t\t\ttransform={rotate}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\t'fill': props.labelTextFill,\n\t\t\t\t\t\t'strokeWidth': 1\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t<text\n\t\t\t\t\tclassName='piechart-label'\n\t\t\t\t\ttransform={t}\n\t\t\t\t\tdy='.35em'\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\t'textAnchor': 'middle',\n\t\t\t\t\t\t'fill': props.labelTextFill,\n\t\t\t\t\t\t'shapeRendering': 'crispEdges'\n\t\t\t\t\t}}>\n\t\t\t\t\t{props.label}\n\t\t\t\t</text>\n\t\t\t</g>\n\t\t)\n\t}\n\trender() {\n\t\tlet props = this.props\n\n\t\tlet arc = d3.arc()\n\t\t\t.innerRadius(props.innerRadius)\n\t\t\t.outerRadius(props.outerRadius)\n\t\t\t.startAngle(props.startAngle)\n\t\t\t.endAngle(props.endAngle)\n\n\t\treturn (\n\t\t\t<g className='piechart-arc' >\n\t\t\t\t<path\n\t\t\t\t\td={arc()}\n\t\t\t\t\tfill={props.fill}\n\t\t\t\t\tstroke={props.sectorBorderColor}\n\t\t\t\t\tonMouseOver={props.handleMouseOver}\n\t\t\t\t\tonMouseLeave={props.handleMouseLeave}\n\t\t\t\t/>\n\t\t\t\t{props.showOuterLabels ? this.renderOuterLabel(props, arc) : null}\n\t\t\t\t{props.showInnerLabels ? this.renderInnerLabel(props, arc) : null}\n\t\t\t</g>\n\t\t)\n\t}\n}\nexport default Arc\n"]}